\documentclass[11pt]{article}
\usepackage{color, array, graphics}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{mathtools}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{float}
\usepackage{listings}
\usepackage[utf8]{inputenc}

\begin{document}
\lstset{stringstyle=\ttfamily,
	showstringspaces=false,
	basicstyle=\small}

\begin{center} Alexander Garcia \hfill June 28, 2017 \\ Assignment-5 \end{center}

\medskip

\begin{enumerate}

	\item $$I = \int_{-1}^{1}e^{-2x} dx$$

	\begin{enumerate}

		\item Approximation using the composite trapezoidal rule.

		The general formula for the composite trapezoidal rule is
		\[
		I(f) = \frac{h}{2}[f(a)+f(h)+2\sum_{j=1}^{k-1}f(a+jp)]
		\]
		where $h$ is the width of the total interval, $p$ is the node width, and $k$ is the total number of nodes. In this case, $h=p = 0.5$, $k=4$, and $f = e^{-2x}$.

		Then, according to the rule,

		\[
		I(f) = \frac{0.5}{2}[f(-1) + f(1) + 2\sum_{j=1}^{3}f(a+jp)]
		\]

		or

		\[
		I(f) = \frac{1}{4}[e^{-1} + e + 2[e^{-1+0.5} + e^{-1+1} + e^{-1+1.5}]]
		\]

		When the expression is evaluated, we get the composite trapezoidal approximation of the integral to be
		\[
		I(f) \approx 2.399166\ldots
		\] \

		We know that the error for this formula can be expressed by $-\frac{h^2}{12}(b-a)f''(\eta)$, where $\eta$ is an unknown location within the interval. Rather than use an unknown location, we can bound the error by the maximum of the second derivative over the interval.

		\[f''(x) = 4e^{-2x} \leq 4e^2\ \ x\in[-1,1]\]

		Therefore, the maximum error of this approximation is
		\[
		\frac{0.5^2}{12}(1-(-1))(4e^2) \approx 1.231509\ldots
		\]

		which makes our result not very significant. \\

		\item Approximation using composite Simpson's rule

		We can define composite Simpson's rule in this case as the following
		\[
		I(f) = \frac{h}{3}\sum_{j=2}^{8}(f(a+(j-2)h) + 4f(a+(j-1)h) + f(a+jh))
		\]

		In our case, $k = 4$, and $p = \frac{b-a}{k}$, so $h = \frac{p}{2}$. We can write out the full summation then as \\

		$\frac{h}{3}$[
		\begin{tabular}{ll}
			$f(-1) + 4f(-0.75) + f(-0.5)$ & $+$ \\
			$f(-0.5) + 4f(-0.25) + f(0)$ & $+$ \\
			$f(0) + 4f(0.25) + f(0.5)$ & $+$ \\
			$f(0.5) + 4f(0.75) + f(1)$
		\end{tabular}
		] \\

		The overall error of Simpson's rule approximation can be written as

		\[
		E \leq -\frac{b-a}{180}h^4max(f''(x))\ \ x\in[-1,1]
		\]

		We can easily see that the $max(f''(x)) = 16e^2$ for our interval, so the upper bound on the error is

		We can then calculate the upper bound on the error.

		\[
		E \leq -\frac{2}{180}(0.25^4)(16e^2)
		\]
		\[
		E \leq -0.00513129\ldots
		\]

		This makes composite Simpson's approximation a much better estimate of the integral than composite trapezoidal approximation. \\

		\item For the composite trapezoidal rule, we are given that the error is defined by

		\[
		|E| \leq \frac{h^2}{12} (b-a) max(f''(x)) < 10^{-6}\ \ x\in[a,b]
		\]

		As we are simply solving for the node spacing $h$, we can rearrange this equation to gain an expression for its value.

		\[
		h  < \sqrt{\frac{12\delta}{(b-a)M}}
		\]

		where

		$M=max(f''(x))\ x\in[-1,1] = 4e^2$

		$\delta=10^{-6}$, and

		$b-a=2$.

		When these values quantities are used, we get

		\[
		h < (\sqrt{\frac{12*10^{-6}}{2*4e^2}} \approx 0.000450558\ldots)
		\] \

		\item We have a similar expression for the error of Simpson's rule

		\[
		|E| \leq \frac{b-a}{180}h^4max(f^{(iv)}(x)) < 10^{-6}\ \ x\in[a,b]
		\]

		We can again rearrange this equation to solve for $h$, the minimum node spacing to ensure an error of $\leq 10^{-6}$

		\[
		h < (\frac{180\delta}{(b-a)M})^{1/4}
		\]

		where $M=max(f^{(iv)}(x))\ \ x\in[-1,1] = 16e^2$

		$\delta = 10^{-6}$, and

		$b-a=2$.

		This inequality gives us a minimum node spacing of

		\[
		h < ((\frac{180*10^{-6}}{2*16e^2})^{1/4} \approx 0.0295381\ldots)
		\] \

	\end{enumerate}

	\item Holmes 6.18

	\begin{enumerate}[(a)]

	\item $I_S(n) = \frac{2}{3}I_T(n) + \frac{1}{3}I_M(n/2)$

	\item $I_S(n) = \frac{4}{3}I_T(n) - \frac{1}{3}I_T(n/2)$

	\end{enumerate}

\end{enumerate}

\end{document}
